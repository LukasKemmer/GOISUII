\documentclass[ngerman, a4paper,12pt]{article}

%\usepackage[applemac]{inputenc} % Bei Benutzung von Apple-Betriebssystemen bitte durch ``\usepackage[applemac]{inputenc}'' ersetzen.
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage[ngerman]{babel} 
\usepackage{fixltx2e}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{placeins}
\usepackage{eurosym}
\usepackage{amssymb,amsmath}

\usepackage{graphicx} 
\usepackage{color}
\definecolor{kit}{cmyk}{1,0,0.6,0}

\usepackage{hyperref}
\hypersetup{pdftoolbar=true,
            pdfmenubar=true,
            pdfpagemode=UseOutlines,
            bookmarksnumbered=true,
            linktocpage=true,
            colorlinks=false,
            %backref, % Entkommentieren, um zu sehen, ob alle Literaturstellen im Text zitiert werden.
            colorlinks=false
            }

\newtheorem{definition}{Definition}[section]
\newtheorem{satz}[definition]{Satz}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{korollar}[definition]{Korollar}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{bemerkung}[definition]{Bemerkung}
\newtheorem{beispiel}[definition]{Beispiel}
\newtheorem{problem}[definition]{Problem}
\newtheorem{Voraussetzung}[definition]{Voraussetzung}
\newtheorem{algorithmus}[definition]{Algorithmus}
\newtheorem{vermutung}[definition]{Vermutung}

\setlength{\parindent}{0pt}
\parskip1.5ex

\newcommand{\R}{\mathbb R} % Beispiel für die Definition eines eigenen Befehls

\begin{document}

\begin{flushleft}
\vspace*{-100pt}
\textbf{Institut f\"ur Operations Research \\
Prof. Dr. Oliver Stein \\}
Sommersemester 2018
\vspace*{15pt}
\end{flushleft}

\begin{flushright}
\vspace*{-80pt}
\includegraphics[scale=0.5]{kit_logo}
\vspace*{15pt}
\end{flushright}

\begin{center}
\textbf{Zweite Bonusübung zur Vorlesung \\
\emph{Globale Optimierung I}}        
\end{center}

\begin{table}[h]
	\centering
	\begin{tabularx}{\textwidth}{X X X X X}
		 & Vorname & Nachname & Matr.Nr. & Bachelor / Master \\
		\toprule
		1. Mitglied & Leon & Qadirie & 1720201 &  Master\\
		2. Mitglied & Lukas & Kemmer & 1725171 &  Master\\
		\bottomrule
	\end{tabularx}
\end{table}
\textbf{Aufgabe S2.1} \\
(a) Das lineare Gleichungssystem
\begin{equation}
  (A^TA+\alpha R^TR)x=A^Tb
\end{equation}
besitzt genau dann eine eindeutige Lösung, wenn $A^TA+\alpha R^TR$ invertierbar ist. Weiterhin gilt
\begin{equation*}
	\begin{split}
		Kern(A^TA + \alpha R^T R) &= \{x \in \mathbb{R}^n \ | \ A^TAx + \alpha R^TRx = 0 \} \\
	&=\{x \in \mathbb{R}^n \ | \ x^TA^TAx + \alpha x^TR^TRx = 0 \} \\
	\end{split}
\end{equation*}
mit $x^TA^TAx = \| Ax \| _2^2 \geq 0$ und $\alpha x^TR^TRx = \alpha \| Rx \| \geq 0$ (wegen $\alpha >0$). Damit folgt, dass 
\begin{equation}
	x^TA^TAx + \alpha x^TR^TRx = 0
\end{equation}
nur dann erfüllt ist, wenn beide Summanden $0$ sind, d.h. wir suchen ein $x$ für das sowohl $x^TA^TAx=0$ als auch $x^TR^TRx=0$ gilt (wegen $\alpha>0$ muss $\alpha$ hier nicht berücksichtigt werden). Aus
\begin{equation*}
	\begin{split}
		Kern(A) \cap Kern(B) &= \{x \in \mathbb{R}^n \ | \ Ax=0 \} \cap \{x \in \mathbb{R}^n \ | \ Rx=0 \} \\
		&=\{x \in \mathbb{R}^n \ | \ x^TA^TAx=0 \land x^TR^TRX=0 \} \\
		&=\{0\}
	\end{split}
\end{equation*}
folgt, dass diese Vorderung nur für $x=0$ erfüllt ist. Damit gilt $Kern(A^TA + \alpha R^TR) = \{0\}$ und damit nach Satz 5 der mathematischen Grundlagen, dass $A^TA + \alpha R^TR$ invertierbar ist. Die eindeutige Lösung des linearen Gleichungssystems ist dann
\begin{equation*}
	\begin{split}
	(A^TA+\alpha R^TR)x &=A^Tb \\
	\Leftrightarrow x&= (A^TA+\alpha R^TR)^{-1} A^Tb	
	\end{split}
\end{equation*}
% und es folgt
%\begin{equation}
%	x = (A^TA+\alpha R^TR)^-1 A^Tb.
%\end{equation}
%Gemäß $A6$ besitzt $A^TA+\alpha R^TR$ vollen Rang, so $Kern(A^TA+\alpha R^TR=\{0\}$
%Kern(A)\cap Kern(R)=\{0\} \Rightarrow \{x\in \mathbb R^n|Ax=0\}\cap\{x\in\mathbb R^n|Rx=0\}
%Es gilt: $Kern(A^TA+\alpha R^TRx)$\\[10pt]
%=$\{x\in\mathbb R^n|(A^TA+\alpha R^TR)x=0\}$\\[10pt]
%=$\{x\in \mathbb R^n|\underbrace{A^TA}_{n\times n,\succeq 0}x\}+\alpha\underbrace{R^TR}_{n\times n,\succeq 0}x=0\}=\{0\}\quad$ \footnote{Positiv semidefinit da Gram-Matrix}\\[10pt]
%=$\{x\in \mathbb R^n|x^T\underbrace{A^TA}_{\geq 0}x\}+\alpha x^T\underbrace{R^TR}_{\geq 0}x=0\}=\{0\}$\\[10pt]
%da nur für $x=0:(Ax=0)\wedge (Rx=0)$.
%\textcolor{red}{Damit ist $A^TA+\alpha R^TR$ invertierbar}
\par
(b) Sei $f: \mathbb{R}^n \rightarrow \mathbb{R}$ mit $f(x) = \|Ax-b \|_2^2 + \alpha \|Rx \|_2^2$. Wegen $D^2( \|x \|_2^2)=2I \succeq 0$, der Linearität von $Ax-b$ sowie $Rx$ und $\alpha > 0$ folgt mit Übung 4.6 und Satz 2.5.3 die Konvexität von $f$ als Summe konvexer Funktionen (merke, dass es sich um ein unrestringiertes Problem mit $M=\mathbb{R}^n$ handelt und der $\mathbb{R}^n$ eine konvexe Menge ist). Mit Satz 2.4.5 und Korollar 2.4.6 folgt, dass die kritischen Punkte von $f$ genau die globalen Minimalpunkte sind. Es gilt
\begin{equation}
	\nabla f(x) = 2A^T(Ax-b) + 2\alpha R^TRx
\end{equation}
und damit
\begin{equation*}
	\begin{split}
		2A^T(Ax-b) + 2\alpha R^TRx &= 0 \\
		\Leftrightarrow A^TAx-A^Tb+\alpha R^TRx &=0 \\
		\Leftrightarrow (A^TA+\alpha R^TR)x &=A^Tb.
	\end{split}
\end{equation*}
Damit ist die eindeutige Lösung des linearen Gleichungssystems aus (a) genau der eindeutige globale Minimalpunkt von $P$.
%Es handelt sich bei dem Gleichungssystem aus (a) offensichtlich um ein konvexes Optimierungsproblem.
%Entsprechend sind alle kritischen Punkte auch Nullstellen.
%Es gilt:
%$\nabla_x f(x)=A^T(Ax-b)+\alpha R^TRx\stackrel{!}{=}0$\\[5pt]
%$\Leftrightarrow A^TAx-A^Tb+\alpha R^TRx=0$\\[5pt]
%$\Leftrightarrow (A^TA+\alpha R^TR)x=A^Tb$\\[5pt]
%q.e.d.
\par
\textbf{Aufgabe S2.2} \\
(a) R:=L, \textcolor{red}{b:=Y}, A:=I.
\begin{equation*}
	L = \begin{pmatrix}
	1 &-1 & 0 \cdots &0 &0\\
	0 & 1 & -1 \cdots &0 &0\\
	\vdots & \vdots & \vdots & \vdots & \vdots \\
	0 & 0 & \cdots & 1 & -1\\ 
	\end{pmatrix} \in \mathbb R^{(n-1)\times n}
\end{equation*}
Rest s. Python.

\par
(b) \textcolor{red}{Why not? Deutlich smoother?!. Ergibt Sinn, so Funktion smooth ist. Etc.; Ausgelassen da unklar}

\par
(c) Es gilt:\\[10pt]
\begin{equation*}	
CRL_1: \min_{x\in\mathbb R^n,z}\|x-y\|_2^2+\alpha\|z\|_1\quad \text{s.t. $z=Lx \Leftrightarrow z-Lx=0$  \textcolor{red}{weiter konnte ich nicht lesen :D}}
\end{equation*}

\begin{equation*}
\Rightarrow L(x,z,\mu)=\|x-y\|_2^2+\alpha \|z\|_1+\mu^T(z-Lx)
\end{equation*}

\begin{equation*}
LD: \max_{\mu} \inf_{x,z} \|x-y\|_2^2+\alpha\|z\|_1+\mu^Tz-\mu^TLx  
\end{equation*}

\begin{equation*}
  \Rightarrow \underbrace{\inf_{x,z} (\|x-y\|_2^2-\mu^TLx)}_{a} + \underbrace{\inf_z(\mu^Tz+\alpha\|z\|_1)}_{b}
\end{equation*}

Für $a$ gilt:
\begin{equation*}
  a: 2(x-y)-L^T\mu\stackrel{!}{=} 0 \Leftrightarrow x=y+0,5L^T\mu
\end{equation*}
\begin{equation*}
  \Rightarrow \textcolor{red}{\inf_x(...)}=\frac{1}{4}\mu^TLL^T\mu-\mu^TLy-\frac{1}{2}\mu^TLL^T\mu=-\frac{1}{4}\mu^TLL^T\mu-\mu^TLy
\end{equation*}


Für $b$ gilt:
\begin{equation*}
  \Rightarrow \inf_x (\mu^Tz+\alpha\|z\|_1)=\inf_z \sum_{i=1}^{n-1}(\mu_iz_i+\alpha|z_i|)
\end{equation*}
\begin{equation*}
  = \sum_{i=1}^{n-1} \inf_{z_i} (\mu_iz_i+\alpha|z_i|)
\end{equation*}

Sei\footnote{\textcolor{red}{Im Folgenden nicht alle Nebenrechnungen aufgeführt}} nun $\mu\leq\alpha$.

\begin{equation*}
\inf_{z_i} \mu_iz_i+\alpha|z_i|=\begin{cases}
	0,& |\mu_i|\leq \alpha\\
	-\infty,& |\mu_i|>\alpha\\
\end{cases}
\end{equation*}
aufgrund $z_i\geq0:\mu_iz_i+\alpha z_i=(\mu_i+\alpha)z_i$.
\begin{equation*}
  \inf_z \mu^Tz+\underbrace{\alpha\|z\|_1}_{\geq0}=\begin{cases}
  	-\infty,&\exists i:|\mu_i>\alpha\\
  	0,&\|\mu\|_\infty\leq\alpha\\
  \end{cases}
\end{equation*}

\begin{equation*}
  \Rightarrow \max_\mu \|x-y\|_2^2+\alpha\|z\|_1+\mu^T(z-Lx)
\end{equation*}
\begin{equation*}
  \Leftrightarrow \max_\mu -\frac{1}{4}\mu^TLL^T\mu-\mu^TLy,\quad \text{s.t. } \|\mu\|_\infty\leq\alpha
\end{equation*}

\par
(d) \par



\textbf{Aufgabe S2.3} \\

(a) \textcolor{red}{Ausgelassen da unklar, inwiefern bereits verwertbar}


\par
(b)  
\par
(c) 
\par
(d) 
\par
(e)
\par
\end{document}